"use strict";(self.webpackChunkrm_frontend=self.webpackChunkrm_frontend||[]).push([[45],{1363:function(t,e,i){i.r(e);var s=i(311),o=i(320),r=i(1364),a=i(1303),n=i(1043),h=i(339),l=i(322),u=i(1044),d=i(667),p=i(609),c=i(615),m=function(t,e){this.playerIsReady=!1,this.queue=[],function(t,e){var i=o.Z.bind(t,e);if(window.youTubeApiIsReady)return i();window.ytQueue.push({cb:i,context:e})}((function(){this.yt=new window.YT.Player(t.id,{events:{onReady:o.Z.bind((function(){this.destroyed||(this.playerIsReady=!0,o.Z.each(this.queue,(function(t){o.Z.isFunction(t.cb)&&t.cb()})))}),this)}})}),this),this.start_time=e&&e.start_time};m.prototype={addToQueue:function(t,e){var i=o.Z.bind(t,e);if(this.playerIsReady)return i();this.queue.push({cb:i,context:e})},on:function(t,e,i){var s=o.Z.bind(e,i||window),r={finish:0,play:1,pause:2};"ready"!==t?this.addToQueue((function(){this.yt.addEventListener("onStateChange",(function(e){r[t]===Number(e.data)&&s()}))}),this):this.addToQueue(s,this)},mute:function(){this.addToQueue((function(){this.yt.mute()}),this)},unMute:function(){this.addToQueue((function(){this.yt.unMute()}),this)},pause:function(){this.addToQueue((function(){this.yt&&this.yt.pauseVideo&&this.yt.pauseVideo()}),this)},play:function(){this.addToQueue((function(){this.yt.playVideo()}),this)},rewind:function(t){this.addToQueue((function(){this.yt.seekTo(t||0)}),this)},loop:function(){this.rewind(this.start_time||.01)},getDuration:function(){return this.duration||(this.duration=this.yt.getDuration()),this.duration},getCurrentTime:function(){return this.yt.getCurrentTime&&this.yt.getCurrentTime()||0},checkLoop:function(){if(this.getDuration()-this.yt.getCurrentTime()<.5)return this.loop(),!0},destroy:function(){window.ytQueue=o.Z.reject(window.ytQueue,(function(t){return t.context===this})),delete this.yt,delete this.queue,this.destroyed=!0}};var y=function(t,e){this.player=new r.Z(t),o.Z.bindAll(this),this.id=t.id,this.start_time=e&&e.start_time};y.prototype={on:function(t,e){switch(t){case"ready":this.player.ready().then(e);break;case"finish":this.player.on("ended",e);break;case"playProgress":this.player.on("timeupdate",e);break;case"loadProgress":this.player.on("progress",e);break;default:this.player.on(t,e)}},mute:function(){this.player.setMuted(!0)},unMute:function(){this.player.setMuted(!1)},pause:function(){this.player.pause().catch((function(t){console.error("error vimeo pause video",t.name)}))},play:function(){this.player.play().catch((function(t){console.error("error vimeo play video",t.name)}))},rewind:function(t){this.player.setCurrentTime(t||0).catch((function(e){console.error("error vimeo setting current time ".concat(t),e.name)}))},loop:function(){this.start_time&&this.rewind(this.start_time)},getCurrentTime:function(t){this.player.getCurrentTime().then(t).catch((function(t){console.error("error vimeo getting current time",t.name)}))},setColor:function(t){this.player.setColor(t).catch((function(t){console.error("error vimeo setting color:",t.name)}))},destroy:function(){this.player&&this.player.destroy()}};var f={Vimeo:o.Z.template('<iframe src="https://player.vimeo.com/video/<%=video_id%>?wmode=opaque&api=1&loop=<%=(loop)?1:0%>&muted=<%=(mute)?1:0%>&player_id=video_<%=id%><%=(!real)?"_c":""%>&title=<%=info?1:0%>&byline=<%=info?1:0%>&portrait=<%=info?1:0%>&color=<%=color%>" id="video_<%=id%><%=(!real)?"_c":""%>" width="<%=w%>" height="<%=h%>" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen allow="autoplay; fullscreen; encrypted-media"></iframe>'),YouTube:o.Z.template('<iframe <% if (real) {%>id="yt_<%=video_id%>"<%}%> src="https://www.youtube.com/embed/<%=video_id%>?&wmode=opaque&enablejsapi=1&autohide=1&loop=<%=(loop)?1:0%>&showinfo=<%=info?1:0%>&theme=<%=theme%>&controls=<%=controls? 1: 0%><%=html5 ? "&html5=1" : ""%>&rel=0&vq=hd1080&playsinline=<%=(autoplay)?1:0%>" width="<%=w%>" height="<%=h%>" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen allow="autoplay; fullscreen; encrypted-media"></iframe>')},v=a.Z.extend({RESTART_TIMEOUT:5e3,isPlaying:!1,initialize:function(t,e,i){return a.Z.prototype.initialize.apply(this,arguments),this.$container=i,delete this.real,this},render:function(){return"vimeo"===(this.provider_name||"").toLowerCase()&&n.Z.brokenVimeoThumbnailRegexp.test(this.thumbnail_url)&&(this.thumbnail_url=void 0),this.$container?this.setElement(this.$container):this.makeBox("video"),this.rendered=!0,this.setPosterInsteadOfVideo(),this},isValid:function(){return this.video_id&&this.provider_name},_needAutoStart:function(){return this.autoplay&&!h.Z.PageVisibilityManager.isPageHidden()},start:function(){return a.Z.prototype.start.call(this),this.onPlayFired=!1,RM.screenshot||!this.rendered||this.destroyed||(this.playerInitialized||(this.$el.append(this.getEmbed()),this.$iframe=this.$el.find("iframe"),this.$iframe.attr("id","video_"+this.id),this.player=this.createPlayer(this.provider_name,this.$iframe,{start_time:this.start_time,autoplay:this._needAutoStart()}),this.player&&this.player.on("ready",this.onPlayerReady),this.playerInitialized=!0),this.player&&this._needAutoStart()&&this.player.play()),this},stop:function(){return a.Z.prototype.stop.call(this),clearInterval(this.loopInterval),!RM.screenshot&&!this.destroyed&&this.player&&this.rendered&&("youtube"===this.provider_name.toLowerCase()?(this._needAutoStart()&&this.player.pause(),!this._needAutoStart()&&this.onPlayFired&&this.player.pause()):this.player.pause()),this},destroy:function(){return clearInterval(this.loopInterval),this.player&&this.player.destroy(),this.player=null,a.Z.prototype.destroy.apply(this,arguments)},setPosterInsteadOfVideo:function(){if(this.custom_thumbnail||this.thumbnail_url){var t=this.getCustomThumbnail(this);this.custom_thumbnail&&t.url?this.setCustomPosterInsteadOfVideo():this.setEmbeddedPosterInsteadOfVideo()}else this.widgetIsLoaded()},setEmbeddedPosterInsteadOfVideo:function(){this.$poster&&this.$poster.remove(),this.$poster&&this.$poster.off(),this.$poster=(0,s.ZP)("<img/>").addClass("poster").css("opacity",0).appendTo(this.$el),this.$poster.on("load",o.Z.bind((function(){this.$poster.css({width:"",height:""}).css("opacity",1);var t=this.$poster[0].width,e=this.$poster[0].height;this.aspect_poster||(this.aspect_poster=t/e),n.Z.setVideoPosition({mag:this.page.mag,$container:this.$el,$media:this.$poster,provider:this.provider_name,aspect_poster:this.aspect_poster,aspect_real:this.aspect_real,controls_remove:!!this.$container}),setTimeout(this.widgetIsLoaded,100)}),this)).on("error",o.Z.bind((function(){this.oldUrl=this.thumbnail_url,this.thumbnail_url=this.thumbnail_url.replace("https://","http://"),this.oldUrl!==this.thumbnail_url?this.setEmbeddedPosterInsteadOfVideo():this.widgetIsLoaded()}),this)).attr("src",this.thumbnail_url)},setCustomPosterInsteadOfVideo:function(){var t=this;this.$poster&&this.$poster.remove(),this.$poster&&this.$poster.off(),this.$poster=this.getCustomVideoPoster(this),this.$poster.css({visibility:"hidden",cursor:"pointer"}),this.$poster.on("click",(function(){t.player.play()})),this.$poster.appendTo(this.$el),setTimeout(this.widgetIsLoaded,100)},getCustomVideoPoster:function(t){var e,i,o=(0,c.findImagePath)("./common/video-player/play.svg"),r=(0,s.ZP)("<div/>").addClass("poster poster-custom"),a=this.getCustomThumbnail(t),n=a.unscaledOptimizedUrl||a.url;if(u.Z.useLambdaUrl(a)||u.Z.useLambdaUrlOldProjects(a,"video")){var h={width:t.w};a.originalW&&(h.originalW=a.originalW),a.originalH&&(h.originalH=a.originalH);var l=d.Z.normalizeAnimations(t.animation).reduce((function(t,e){return Math.max(t,d.Z.maxScaleAnimation(e))}),0);h.animationScale=l&&l/100,this.page?h.scale=p.Z.isOnForRatio(this.page.pageViewport,this.page.scale,this.mag.viewOpts)?this.page.scale:1:h.scale=RM.constructorRouter.zoom.getZoom(),n=u.Z.getLambdaUrl(a,h)}r.css({width:t.w,height:t.h}),null!==(e=this.mag)&&void 0!==e&&null!==(i=e.viewOpts)&&void 0!==i&&i.lqip&&(this.$lqipImg=(0,s.ZP)("<div/>").addClass("lqip").css({"background-image":"url(".concat(u.Z.getLqipUrl(a),")"),width:this.w,height:this.h}).appendTo(this.$el));var m=new Image;return m.onload=function(){var t=this;this.$poster&&this.$poster.css({"background-image":"url(".concat(o,"), url(").concat(n,")"),visibility:""}),this.$iframe&&this.$iframe.addClass("fade-out"),this.$lqipImg&&this.$lqipImg.css("opacity",0),setTimeout((function(){t.$lqipImg&&t.$lqipImg.remove()}),200)}.bind(this),m.src=n,r},getCustomThumbnail:function(t){var e=t.custom_thumbnail_url||"";return t.picture||{url:e,type:o.Z.last(e.split("."))}},createPlayer:function(t,e,i){return"vimeo"===t.toLowerCase()?new y(e[0],i):"youtube"===t.toLowerCase()?new m(e[0],i):null},getEmbed:function(t){if(t=t||this,o.Z.defaults(t,{real:!0,w:640,h:320,theme:"dark",color:"3ab9ff",info:!1,controls:!0,id:o.Z.uniqueId("video_"),origin:encodeURIComponent(window.location.protocol+"//"+window.location.hostname)}),Modernizr.safari&&(t.html5=!0),!t.video_id)return null;var e=f[t.provider_name](t),i=this.getCustomThumbnail(t);if(!t.real&&t.custom_thumbnail&&i.url){var r=(0,s.ZP)(e).css("visibility","hidden");return this.getCustomVideoPoster(t).add(r)}return f[t.provider_name](t)},onPlayerReady:function(){if(!this.destroyed&&this.player){if(this.$container&&(this.mute=!0),this.mute?this.player.mute():this.player.unMute(),!this.$container){var t=this.getCustomThumbnail(this);this.custom_thumbnail&&t.url||(this.$iframe&&this.$iframe.addClass("fade-out"),o.Z.delay(o.Z.bind((function(){this.$poster&&this.$poster.css("opacity",0)}),this),125),o.Z.delay(o.Z.bind((function(){this.$poster&&(this.$poster.off(),this.$poster.remove())}),this),250))}this.player.on("pause",this.onPause),this.player.on("play",this.onPlay),this.player.on("finish",this.onFinish),this.start_time&&(this.player.rewind(this.start_time),this.player.pause()),l.Z.isDesktop&&"vimeo"===this.provider_name.toLowerCase()&&this.player.on("playProgress",this.onProgress),this.started&&this._needAutoStart()&&this.player.play(),this.player.setColor&&this.player.setColor(this.color)}},onPlay:function(){this.isPlaying=!0,!this.$container&&RM.analytics&&RM.analytics.sendEvent("Video Play",this.title+" / "+this.url),this.$iframe&&!this.$iframe.hasClass("fade-out")&&(this.$iframe.addClass("fade-out"),this.trigger("playStarted")),clearInterval(this.loopInterval),this.loop&&this.player.checkLoop&&(this.loopInterval=setInterval(o.Z.bind((function(){this.player.checkLoop()&&(clearInterval(this.loopInterval),Modernizr.safari&&o.Z.delay(function(){this.onPlay()}.bind(this),200))}),this),100)),this.$poster&&(this.$poster.off(),this.$poster.remove()),this.onPlayFired=!0},onPause:function(){if(this.isPlaying=!1,"Vimeo"===this.provider_name)this.player.getCurrentTime(o.Z.bind((function(t){t=Math.round(t),!this.$container&&RM.analytics&&RM.analytics.sendEvent("Video Pause",this.title+" / "+this.url+" / "+t+" sec.",t)}),this));else if("YouTube"===this.provider_name){var t=Math.round(this.player.getCurrentTime());!this.$container&&RM.analytics&&RM.analytics.sendEvent("Video Pause",this.title+" / "+this.url+" / "+t+" sec.",t)}},onFinish:function(){this.isPlaying=!1},onProgress:function(t){this.onPlayFired||this.onPlay(),1===t.percent&&this.loop&&this.player.loop&&this.player.loop(),0===parseFloat(t.seconds)?this.restartTimeout||(this.restartTimeout=setTimeout(o.Z.bind((function(){clearInterval(this.loopInterval),this.playerInitialized=!1,this.player&&this.player.destroy(),this.player=null,this.$iframe&&this.$iframe.remove(),!this.destroyed&&this.started&&this.start(),delete this.restartTimeout}),this),this.RESTART_TIMEOUT)):(clearTimeout(this.restartTimeout),delete this.restartTimeout)},updateVideoFrameSize:function(t,e){this.$iframe&&this.$iframe.attr("width",t).attr("height",e),this.$poster&&this.$poster.css({width:t,height:e})}});e.default=v}}]);